function flattenObject(t){return Object.keys(t).reduce(function(e,o){switch(Object.prototype.toString.call(t[o])){case"[object Date]":e[o]=t[o].toString();break;case"[object Object]":if(t[o]){var n=flattenObject(t[o]);Object.keys(n).forEach(function(t){e[o+"."+t]=n[t]})}break;case"[object Array]":console.log(t[o]);default:e[o]=t[o]}return e},{})}function flattenArray(t,e){return Array.isArray(e)?t.concat(flattenArray(e)):t.concat([flattenObject(e)])}!function(t){"use strict";var e=function(e,o,n,r,s,i){this.target=e,this.options=t.extend({host:"https://query.yahooapis.com/v1/public/yql",oauth:null,input:"xml",output:"json",url:o,resource:"",tables:n||"*",params:{},sort:null,offset:0,limit:10,layoutTemplate:"<ul>{entries}</ul>",entryTemplate:"<li>{entry}</li>",effect:"show",tokens:{},error:function(t){var e=t||"No Data Retrieved";console.log(e)},onData:function(){},onSuccess:function(t){}},r||{}),this.options.url=[this.options.url,this.options.resource,"?",t.param(this.options.params)].join(""),this.callback=s||this.options.onSuccess};e.INPUTS=["html","xml","json","rss","atom"],e.OUTPUTS=["xml","json"],e.HTML_TAGS=["doctype","html","head","title","base","link","meta","style","script","noscript","body","article","nav","aside","section","header","footer","h1-h6","hgroup","address","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","figure","figcaption","div","table","caption","thead","tbody","tfoot","tr","th","td","col","colgroup","form","fieldset","legend","label","input","button","select","datalist","optgroup","option","textarea","keygen","output","progress","meter","details","summary","command","menu","del","ins","img","iframe","embed","object","param","video","audio","source","canvas","track","map","area","a","em","strong","i","b","u","s","small","abbr","q","cite","dfn","sub","sup","time","code","kbd","samp","var","mark","bdi","bdo","ruby","rt","rp","span","br","wbr"],e.prototype.load=function(e){var o=this;if(o.api=o.options.host,o.query='select {0} from {1} where url="{2}" limit {3} offset {4}',t.inArray(o.options.input,o.INPUTS)||(o.options.input="xml"),t.inArray(o.options.output,o.OUTPUTS)||(o.options.output=o.options.input),"string"==t.type(o.options.tables)?o.options.tables=o.options.tables.split(","):t.isArray(o.options.tables)||(o.options.tables="*"),this.options.sort&&"string"==typeof this.options.sort){var n='|sort("{0}")'.format(this.options.sort);o.query+=n}o.params={q:o.query.format(o.options.tables.join(","),o.options.input,o.options.url,o.options.limit,o.options.offset),format:o.options.output,callback:e.name},o.request={url:o.api+"?"+t.param(o.params),method:"GET"},o.options.oauth?(o.options.oauth=t.extend({consumer:{key:null,secret:null},signature_method:"HMAC-SHA1",hash_function:function(t,e){return CryptoJS.HmacSHA1(t,e).toString(CryptoJS.enc.Base64)}},{consumer:o.options.oauth}||{}),t.ajax({url:o.request.url,method:o.request.method,data:OAuth(o.options.oauth).authorize(o.request),success:e})):t.ajax({url:o.request.url,method:o.request.method,success:e})},e.prototype.render=function(){var e=this;this.load(function(o){try{e.feed=o.query.results,e.entries=[];for(var n in e.feed)e.entries=e.entries.concat(e.feed[n].reduce(flattenArray,[]))}catch(r){return e.payload=null,e.entries=[],e.options.error.call(e,r.message)}var s=e.generateHTMLForEntries();if(e.target.append(s.layout),0!==s.entries.length){t.isFunction(e.options.onData)&&e.options.onData.call(e);var i=t(s.layout).is("entries")?s.layout:t("entries",s.layout);e.appendEntriesAndApplyEffects(i,s.entries)}})},e.prototype.appendEntriesAndApplyEffects=function(e,o){var n=this;t.each(o,function(t,o){var r=n.wrapContent(o);"show"===n.options.effect?e.before(r):(r.css({display:"none"}),e.before(r),n.applyEffect(r,n.options.effect))}),e.remove()},e.prototype.generateHTMLForEntries=function(){var e=this,o={entries:[],layout:null};return t(this.entries).each(function(){var t=this,n=e.evaluateStringForEntry(e.options.entryTemplate,t);o.entries.push(n)}),this.options.entryTemplate?o.layout=this.wrapContent(this.options.layoutTemplate.replace("{entries}","<entries></entries>")):o.layout=this.wrapContent("<div><entries></entries></div>"),o},e.prototype.applyEffect=function(t,e,o){var n=this;switch(e){case"slide":t.slideDown("slow",o);break;case"slideFast":t.slideDown(o);break;case"slideSynced":n.effectQueue.push({element:t,effect:"slide"});break;case"slideFastSynced":n.effectQueue.push({element:t,effect:"slideFast"})}},e.prototype.executeEffectQueue=function(t){var e=this,o=function(){var n=e.effectQueue.pop();n?e.applyEffect(n.element,n.effect,o):t&&t()};o()},e.prototype.wrapContent=function(e){return t(0!==t.trim(e).indexOf("<")?"<div>"+e+"</div>":e)},e.prototype.evaluateStringForEntry=function(e,o){var n=this,r=e;return t(e.match(/(\{.*?})/g)).each(function(){var t=this.toString();r=r.replace(t,n.getValueForToken(t,o))}),r},e.prototype.getTokenMap=function(e){return this.feedTokens||(this.feedTokens=this.entries.map(flattenObject)),t.extend({feed:this.feedTokens,index:t.inArray(e,this.entries),totalEntries:this.entries.length},this.options.tokens)},e.prototype.getValueForToken=function(t,e){var o=this.getTokenMap(e),n=t.replace(/[\{\}]/g,""),r=o.feed[o.index][n]?o.feed[o.index][n]:o[n];if("undefined"!=typeof r)return"function"==typeof r?r(e,o):r;throw new Error("Unknown token: "+t+", url:"+this.url)},t.fn.yql=function(t,o,n,r){return new e(this,t,o,n,r).render(),this}}(jQuery),String.prototype.format=String.prototype.format||function(){"use strict";var t=this.toString();if(arguments.length){var e,o=typeof arguments[0],n="string"===o||"number"===o?Array.prototype.slice.call(arguments):arguments[0];for(e in n)t=t.replace(new RegExp("\\{"+e+"\\}","gi"),n[e])}return t},Object.resolve=function(t,e){"use strict";return t.split(".").reduce(function(t,e){return t?t[e]:void 0},e||self)};